# AIコーディングエージェント開発規約

# コーディング規約

## 0. 基本的な作業フロー

1. タスク管理の原則
   - すべての作業は必ずIssueとして登録してから着手する
   - 新しい機能追加、バグ修正、改善など、すべての変更はIssueを通して管理
   - Issue作成なしでの作業は禁止

2. 作業の流れ
   ```
   1. Issueの作成
      gh issue create で作業内容を登録
   
   2. ブランチの作成
      作成されたIssue番号を使用してブランチを作成
   
   3. 作業の実施
      コードの変更、テスト、確認
   
   4. 変更のコミット
      必ずIssue番号を含めたコミットメッセージを作成
   
   5. プルリクエストの作成
      レビュー依頼とIssueのクローズ
   ```

3. コミットの原則
   - 作業中の変更は適切な単位で細かくコミット
   - 必ずIssue番号を参照
   - 変更内容が分かりやすいメッセージを記載

## 1. コード品質の基本原則

### 1.1 命名規則
- 変数名は具体的で目的を表す名前を使用する
  - 良い例: `userCount`, `isValidEmail`, `calculateTotalPrice`
  - 悪い例: `a`, `temp`, `x1`
- クラス名はパスカルケース、メソッド名はキャメルケースを使用
- 定数は大文字のスネークケースで記述
- ブール値を表す変数は`is`, `has`, `can`などのプレフィックスを使用

### 1.2 コードの構造化
- 関数は単一の責任を持つ（単一責任の原則）
- 関数の長さは20-30行を目安とし、必要に応じて分割
- ネストは3レベルまでに制限
- 早期リターンを活用し、条件分岐を簡潔に

### 1.3 エラー処理
- 例外は適切に捕捉し、具体的なエラーメッセージを提供
- null/undefined チェックを徹底
- エラー状態を明確に定義し、適切なエラーコードを使用
- エラーログには必要な文脈情報を含める

## 2. コードの保守性

### 2.1 ドキュメンテーション
- 各クラス、メソッドの目的と使用方法を記述
- パラメータと戻り値の型と意味を明記
- 複雑なロジックには説明コメントを追加
- APIドキュメントの自動生成に対応

### 2.2 GitHub運用ガイドライン

#### 2.2.1 Issue管理
- タスクは必ずIssueとして登録
- ghコマンドを使用してIssue管理

```bash
# Issueの作成（新機能）
gh issue create --title "✨ ログイン機能の実装" --body "ユーザー認証システムの実装が必要" --label "feature"

# Issueの作成（バグ）
gh issue create --title "🐛 認証エラーの修正" --body "ログイン時に500エラーが発生する問題の修正" --label "bug"

# Issueの作成（改善）
gh issue create --title "♻️ 認証処理のリファクタリング" --body "認証処理の可読性向上とテスト追加" --label "refactor"

# Issueの作成（ドキュメント）
gh issue create --title "📚 API仕様書の更新" --body "認証APIのドキュメント更新" --label "documentation"

# Issueの一覧表示
gh issue list

# Issueの詳細表示
gh issue view 123

# Issueの割り当て
gh issue edit 123 --assignee "@me"

# Issueのクローズ
gh issue close 123
```

#### 2.2.2 コミットメッセージ規約
- 絵文字プレフィックスを使用
- Issue番号を参照
- フォーマット: `<絵文字> #<Issue番号> <内容>`

コミットメッセージの例:
```bash
# 新機能追加
git commit -m "✨ #123 JWT認証の実装

- JWTを使用したログイン認証の基本機能を実装
- アクセストークンとリフレッシュトークンの発行処理を追加
- トークンの有効期限管理を実装"

# バグ修正
git commit -m "🐛 #456 認証トークンのバリデーション修正

- 無効なトークンを使用した場合のエラーハンドリングを修正
- トークンの期限切れチェックロジックを修正
- エラーメッセージを具体的な内容に変更"

# リファクタリング
git commit -m "♻️ #789 認証処理のモジュール分割

- 認証処理を独立したサービスクラスに分離
- バリデーション処理を共通モジュールに移動
- インターフェースの型定義を追加"

# 設定変更
git commit -m "🔧 #890 開発環境の設定変更

- 環境変数の管理をdotenvに移行
- デバッグログの出力設定を追加
- ESLintの設定ルールを更新"

# ドキュメント更新
git commit -m "📚 #234 API仕様書の更新

- 認証APIのエンドポイント一覧を追加
- リクエスト・レスポンスの例を追加
- エラーレスポンスの詳細を記載"
```

絵文字プレフィックス一覧:

Issueタイトル・コミットメッセージ共通:
- ✨ (sparkles): 新機能
- 🐛 (bug): バグ修正
- ♻️ (recycle): リファクタリング
- 📚 (books): ドキュメント
- ⚡️ (zap): パフォーマンス改善
- 🔧 (wrench): 設定変更
- 🎨 (art): デザイン/UI改善
- 🔒 (lock): セキュリティ関連
- 🚀 (rocket): デプロイ関連

Issue専用:
- 💡 (bulb): 提案/アイデア
- ❓ (question): 質問
- 🔍 (mag): 調査
- 🧪 (test_tube): テスト関連
- 📊 (bar_chart): 分析/計測

### 2.3 バージョン管理
- ブランチ戦略の明確化
- プルリクエストレビューの必須化
- バージョニングルールの統一（セマンティックバージョニング）

## 3. モニタリング

### 3.1 ログ管理
- Loguruを使用したログ管理
  - ログレベルの適切な使用（DEBUG, INFO, WARNING, ERROR, CRITICAL）
  - 構造化ログの実装
  - エラーの追跡性確保
  - ログローテーションの設定

### 3.2 進捗管理
- tqdmを使用した進捗表示
  - ループ処理の進捗表示
  - ファイル処理の進捗表示
  - バッチ処理の進捗表示
  - カスタム進捗バーの実装

## 4. 継続的改善

### 4.1 コードレビュー
- レビューチェックリストの作成
- コードレビューの定期実施
- 改善点の文書化
- ベストプラクティスの共有

### 4.2 リファクタリング
- 技術的負債の定期的な解消
- コードの重複除去
- アーキテクチャの継続的な改善
- コードの可読性向上
